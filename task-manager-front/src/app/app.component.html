<app-confirm-dialog></app-confirm-dialog>
<app-template-picker></app-template-picker>
<app-alert></app-alert>

<div class="main-layout" [class.sidebar-open]="isMdDown() && sidebarOpen()">
  <!-- Sidebar -->
  <app-board-sidebar
    [isMdDown]="isMdDown()"
    [open]="sidebarOpen()"
    [forceFullscreen]="!hasBoards()"
    [selectedId]="selectedBoardId()"
    (boardSelected)="onBoardSelected($event)"
    (requestClose)="closeSidebar()"
  ></app-board-sidebar>

  <!-- Backdrop (mobile/tablet) -->
  <div
    class="sidebar-backdrop"
    (click)="closeSidebar()"
    [class.visible]="isMdDown() && sidebarOpen() && hasBoards()"
  ></div>

  @if (selectedBoardId() !== null) {
  <section class="board-area">
    <app-board-toolbar
      [isMdDown]="isMdDown()"
      [boardId]="selectedBoardId()!"
      [boardName]="selectedBoardName()"
      (requestOpenSidebar)="openSidebar()"
      (boardChangeAfterDelete)="onAfterDelete($event)"
    ></app-board-toolbar>

    <app-board [boardId]="selectedBoardId()!"></app-board>
  </section>
  } @else {
  <!-- Keep a header actions slot with the Account ID button -->
  <section class="board-area board-area--empty">
    <div class="empty-actions">
      <button
        type="button"
        class="uid-btn"
        (click)="showAccountDialog.set(true)"
        [attr.aria-label]="'identity.openTooltip' | transloco"
        [title]="'identity.openTooltip' | transloco"
      >
        <img
          src="/svg/share.svg"
          width="18"
          height="18"
          [attr.alt]="'identity.title' | transloco"
        />
      </button>
    </div>
  </section>
  }
</div>

<footer class="app-footer">
  Â© {{ currentYear }} {{ "app.brand" | transloco }}.
  {{ "app.copyright" | transloco }}
</footer>

<!-- Global dialog instance used by the empty-state button -->
<app-account-id-dialog
  [open]="showAccountDialog()"
  (close)="showAccountDialog.set(false)"
  (switched)="onUidSwitchedFromApp($event)"
></app-account-id-dialog>

<app-loading-overlay></app-loading-overlay>
