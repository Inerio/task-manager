<!-- Global confirmation dialog and alert system (always available) -->
<app-confirm-dialog></app-confirm-dialog>
<app-alert></app-alert>

<div class="header">
  <h1>Task Manager</h1>
  <!-- Delete all tasks button (calls method in TS) -->
  <button class="delete-btn" (click)="deleteAllTasks()">🗑️</button>
</div>

<div class="task-columns">
  <!-- Render each kanban list dynamically -->
  @for (list of lists(); track list.id) {
  <app-task-list [listId]="list.id!" [title]="list.name"></app-task-list>
  }

  <!-- "Add new list" column: visible only if lists < max -->
  <div class="add-list-column" *ngIf="lists().length < MAX_LISTS">
    @if (!showAddListForm) {
    <button class="add-list-btn" (click)="showAddListForm = true">
      + Add List
    </button>
    } @else {
    <div class="add-list-form">
      <input
        type="text"
        [value]="newListName()"
        (input)="onListNameInput($event)"
        placeholder="New list name"
        required
        autofocus
      />
      <button (click)="addList()">Add</button>
      <button (click)="showAddListForm = false">Cancel</button>
      <!-- Error message, only for backend errors (duplicate, etc.) -->
      @if (addListError()) {
      <div class="add-list-error">{{ addListError() }}</div>
      }
    </div>
    }
  </div>
</div>
